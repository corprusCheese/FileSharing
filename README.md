Это - файлообменник, созданный на основе Yii2 Basic Project Template.

Требования
------------

Для запуска понадобится интерпретатор PHP 7 (7.3.4), Apache 2.4, MySQL.

Установка
------------

 - Через composer установить пакеты и Yii2 фреймворк.
 
 - Корень сервера - в папке web.

## Базы данных

В filesharingdb.sql содержится скрипт на создание таблиц для моделей.

Необходимо назвать рабочую базу данных filesharingdb.

Также нужно выполнить миграцию таблиц для RBAC:

    php yii migrate --migrationPath=@yii/rbac/migrations

После этого нужно инициализировать роли и создать админа (если хотите пользоваться админкой):

    php yii rbac/init
    php yii rbac/create-admin

## Тесты

Если вы хотите запускать тесты, то нужно создать такую же базу, но под названием filesharingdb_test.

Если вы хотите запускать приемочные тесты, нужно сначала запустить GeckoDriver, а потом Selenium Webdriver.

Скачать GeckoDriver для mozilla: <a>https://github.com/mozilla/geckodriver/releases</a>

Selenium установится через composer.

Тесты запускать вот так

    vendor/bin/codecept run

## Sphinx

Поиск файлов работает через Sphinx, так что нужно его скачать, желательно его последнюю версию. Я сунул его прямо в диск C.

В репозитории лежит файл sphinx.conf, его нужно положить в корневую папку со сфинксом, а также в папку bin.

Также рекомендуется создать службу, которая отвечает за сфинкс, для простоты и понятности.

    C:\Sphinx\bin\searchd --install --config C:\Sphinx\sphinx.conf.in --servicename SphinxSearch

Чтобы данные обновлялись, время от времени нужно делать переиндексацию. Я делаю это так (сначала переиндексировать, а потом перезапуск службы):

    C:\Sphinx\bin\indexer --all --config C:\Sphinx\sphinx.conf --rotate

    net stop SphinxSearch && net start SphinxSearch

Впрочем, тут используются rt индексы, и поэтому при сохранении новых данных все будет записываться в них, так что технически данные будут обновляться.

API
------------

Также в файлообменнике есть API, но он поддерживает только GET запросы, формат можно переключать параметром _format и задавать json либо xml; им можно пользоваться без аутентификации.

PS
------------
 - Всё ещё планируется убрать лишние телодвижения для человека, который в теории это скачает и установит, через Docker.

Однако это не в ближайшее время, так как все docker-image для yii2 упорно требует linux, а у меня Windows 10 Home и поддерживаются только windows контейнеры.

 - В файлообменнике используется Jplayer для воспроизведения музыки и видео, css для него я успешно позаимствовал отсюда, добавив немного своего, конечно же.

<a>https://atuin.ru/blog/adaptivnyj-shablon-dlya-proigryvatelya-jplayer/</a>